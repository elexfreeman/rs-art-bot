rs-bot-art — Telegram-бот для акварельных работ

Что делает
- Принимает фото (акварельная картина) в личных сообщениях.
- Анализирует цвета изображения и генерирует продающий текст (RU).
- Публикует фото с подписью в указанный Telegram-канал.

Быстрый старт
1) Создайте бота у @BotFather и получите токен.
2) Добавьте бота администратором в ваш канал.
3) Узнайте числовой ID канала (формат -100xxxxxxxxxxxx).
https://api.telegram.org/bot{our_bot_token}/getUpdates
   - Самый простой способ — переслать любое сообщение из канала боту @userinfobot или @getidsbot.
4) Создайте файл .env в корне проекта:

   TELOXIDE_TOKEN=123456:ABC-DEF...  # токен вашего бота
   OPENAI_API_KEY=sk-...             # ключ OpenAI для генерации текста
   # (опц.) OPENAI_MODEL=gpt-4o-mini # модель; по умолчанию gpt-4o-mini
   # (опц.) OPENAI_BASE=https://api.openai.com # кастомный base URL (прокси)
   # (опц.) OPENAI_USE_VISION=true   # включить анализ изображения (Vision)
   # (опц.) OPENAI_VISION_MODEL=gpt-4o  # модель для Vision (gpt-4o(-mini) и др.)

5) Соберите и запустите:

   cargo run --release

6) В личку боту отправьте команду:

   /set_channel -1001234567890

7) Теперь отправьте боту фото — он сгенерирует текст и опубликует пост в канал.

CLI-конфигурация
- Можно передать настройки напрямую в параметре `--config-json`:

  cargo run --release -- --config-json '{"channel_id": -1001234567890}'

- Если параметр передан — он переопределяет `config.json` и переменные окружения для соответствующих полей.

Настройки
- Канал хранится в config.json в корне проекта.
- Переменная окружения CHANNEL_ID может быть указана до первого запуска.

Команды бота
- /start — проверка готовности.
- /help — список команд.
- /set_channel <id> — задать канал (только числовой ID).
- /settings — показать текущие настройки.

Заметки
- Бот переиспользует file_id для пересылки фото в канал, поэтому повторной загрузки не требуется.
- Анализ изображения локальный (подбор доминирующих оттенков) — дополняет Vision.
- Подпись укладывается в лимит Telegram (до 1024 символов).
 - Vision: изображение кодируется в base64 и передаётся в Chat Completions как data URL. Если Vision выключен или недоступен — используется текстовая генерация с локальными признаками.
